import React from "react";
import { Flex, Text, Image, Box, Heading } from "@chakra-ui/react";
import { getAssetsURL } from "helpers/helperFunction";
import { pieData } from "common/values";
import PieChart from "components/pieChart";
import { IssueSeverityDistribution } from "common/types";

const VulnerabilityChart: React.FC<{
  issue_severity_distribution: IssueSeverityDistribution;
  issue_count: number;
  theme?: string;
}> = ({ issue_severity_distribution, issue_count, theme = "dark" }) => {
  const assetsUrl = getAssetsURL();

  return (
    <Box
      w={"330px"}
      p={"20px"}
      display="flex"
      justifyContent="center"
      alignItems={"center"}
      h="330px"
      position={"relative"}
    >
      {issue_count === 0 ? (
        <Flex flexDir="column" justifyContent="center" alignItems="center">
          <Image src={`${assetsUrl}common/fixedIssueIcon.svg`} />
          <Text> No Bugs Found </Text>
        </Flex>
      ) : (
        <>
          <PieChart
            data={pieData(
              issue_severity_distribution.critical,
              issue_severity_distribution.high,
              issue_severity_distribution.medium,
              issue_severity_distribution.low,
              issue_severity_distribution.informational,
              issue_severity_distribution.gas
            )}
            page={"quickscan"}
          />
          <Flex
            position={"absolute"}
            flexDir={"column"}
            alignItems={"center"}
            justifyContent={"center"}
            color={theme === "light" ? "black" : "white"}
          >
            <Heading fontWeight={900}>
              {issue_severity_distribution.critical +
                issue_severity_distribution.high +
                issue_severity_distribution.medium +
                issue_severity_distribution.low +
                issue_severity_distribution.informational +
                issue_severity_distribution.gas}
            </Heading>
            <Text textAlign="center">
              Total Vulnerabilities <br /> found
            </Text>
          </Flex>
        </>
      )}
    </Box>
  );
};

export default VulnerabilityChart;
